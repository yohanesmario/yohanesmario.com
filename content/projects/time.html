+++
title = "Time"
date = "2020-07-31"
author = "Yohanes Mario Chandra"
+++
<main class="main"></main>
<script>
    // get timezone from `tz` query param
    const urlParams = new URLSearchParams(window.location.search);
    const tz = urlParams.get('tz') || 'UTC';
    var offset = 0;

    // fetch timestamp from an ntp
    fetch('https://worldtimeapi.org/api/ip', { method: 'GET', mode: 'cors' })
        .then(response => response.json())
        .then(data => {
            // get the timestamp from the ntp server
            const timestamp = new Date(data.datetime).getTime();
            // get timestamp offset from local
            offset = timestamp - Date.now();
        })
        .catch(error => {
            console.error('Error fetching timestamp:', error);
        });
    
    // function to update the current time
    function updateTime() {
        const main = document.querySelector('.main');
        // get current time based on the timezone
        const now = new Date(Date.now() + offset);
        const currentTime = now.toLocaleTimeString('en-US', { timeZone: tz, hour: 'numeric', minute: 'numeric', hour12: false });
        const currentDate = now.toLocaleDateString('en-ID', { timeZone: tz, weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        // update the content of the element with the class `main` to display the current time
        main.innerHTML = `<div><div class='time'>${currentTime}</div><div class='date'>${currentDate} <span class='tz'>(${tz})</span></div></div>`;
        // add more clock for timezones: Asia/Makassar, Miami/Florida
        main.innerHTML += `<div><div class='time-small'>${now.toLocaleTimeString('en-US', { timeZone: 'America/New_York', hour: 'numeric', minute: 'numeric', hour12: false })}</div><div class='date-small'>${now.toLocaleDateString('en-ID', { timeZone: 'America/New_York', weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}  <span class='tz'>(Miami)</span></div></div>`;
    }
    
    // update the time every 500ms
    setInterval(updateTime, 500);
    
    // when dom is loaded, update element with the class `main` to display the current time using digital clock format
    document.addEventListener('DOMContentLoaded', updateTime);

    // on click, rotate the entire page 90 degrees more
    document.addEventListener('click', function() {
        document.body.style.transform = `rotate(${(parseInt(document.body.style.transform.replace('rotate(', '').replace('deg)', '')) || 0) + 90}deg)`;
    });
</script>
</script>
<style>
    .main {
        display: flex;
        height: 100%;
        justify-content: center;
        align-items: center;
        text-align: center;
        font-family: Arial;
        flex-direction: column;
    }

    .time {
        font-size: 12em;
        font-weight: bold;
    }

    .date {
        font-size: 2em;
        display: inline-flex;
        align-items: center;
    }

    .time-small {
        padding-top: 1em;
        font-size: 4em;
        font-weight: bold;
    }

    .date-small {
        font-size: 1em;
        display: inline-flex;
        align-items: center;
    }

    .tz {
        color: #888;
        margin-left: 0.5em;
    }
</style>
